<HTML>
<HEAD>
<TITLE> Журнал ЦПО. Дистанционное обучение. </TITLE>
</HEAD>
<BODY BGCOLOR="#EFEFEF" TEXT="Black" LINK="Teal" VLINK="Gray" ALINK="#B3CFC4">
<TABLE WIDTH="100%" BORDER="0" CELLSPACING="0" CELLPADDING="0">
<TR>
<TD  width=3%  ROWSPAN="2" BGCOLOR="#82B496">&nbsp;</TD>
<TD  width=3% ROWSPAN="2" BGCOLOR="Black">&nbsp;</TD>
<TD  width=88% ALIGN="CENTER" BGCOLOR="Gray">
<FONT COLOR="White">
<EM>Компьютерные</EM><BR>
<FONT SIZE="+1"><STRONG>ИНСТРУМЕНТЫ</STRONG></FONT><BR>
<EM>в образовании</EM>
</FONT></TD>
<TD  width=3% ROWSPAN="2" BGCOLOR="Black">&nbsp;</TD>
<TD  width=3% ROWSPAN="2" BGCOLOR="#82B496">&nbsp;</TD>
</TR><TR><TD BGCOLOR="Black">&nbsp;</TD>
</TR><TR><TD COLSPAN="5" ALIGN="CENTER" VALIGN="MIDDLE" BGCOLOR="#82B496">
<FONT SIZE="-1">
<HR SIZE="1" NOSHADE>
[ <A HREF="index.htm">начало</A> ] [ <A HREF="http://www.aec.neva.ru/center/">ЦПО</A> ] [ <A HREF="mailto:pozdnkov@aec.neva.ru">e-mail</A> ] 
<HR SIZE="1" NOSHADE>
</FONT>
</TD></TR></TABLE>
<TABLE WIDTH="100%" BORDER="0" CELLSPACING="0" CELLPADDING="0" ALIGN="CENTER" VALIGN="MIDDLE" NOWRAP BGCOLOR="#82B496">
<TR><TD WIDTH="30%" ALIGN="CENTER" VALIGN="MIDDLE"><FONT COLOR="White" SIZE="+2"><EM>  

Учебная мастерская

</EM></FONT></TD><TD WIDTH="70%" BGCOLOR="#EFEFEF"><P ALIGN="RIGHT"><FONT SIZE="-1"><EM>

Костин В.А.
</EM></FONT></P><H3 ALIGN="CENTER">

Задача о складывании марок.
   
</H3><p>&nbsp;</TD></TR></TABLE>







<!-- -- -->
<TABLE WIDTH="100%" BORDER="0" CELLSPACING="0" CELLPADDING="3" BGCOLOR="#82B496">
<TR><TD COLSPAN="2" align=center><font size="+1" color=white>

&nbsp;</font></TD></TR></TABLE>
<TABLE WIDTH="100%" BORDER="0" CELLSPACING="0" CELLPADDING="3" BGCOLOR="#82B496">
<TR><TD WIDTH="97%" BGCOLOR="#EFEFEF"><BLOCKQUOTE><P>&nbsp;<p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;
Данная статья посвящена разбору одной задачи, предлагавшейся несколько лет назад на городском туре олимпиады по информатике. Ее возникновение связано с одним из сюжетов популярной математики - складывание полосок марок. Эта тема рассмотрена, например, в книгах Мартина Гарднера [1] и Генри Э. Дьюдени [2].
<p>&nbsp;&nbsp;&nbsp;&nbsp;
В качестве языка реализации алгоритмов выбран язык Паскаль, на который также ориентирована вся терминология, связанная с программированием.
<p>&nbsp;&nbsp;&nbsp;&nbsp;
Рассмотрим вначале задачу о складывании единичной полоски марок. Пусть задана прямоугольная полоска бумаги формы 1(n, разбитая на n единичных клеток (марок). Все клетки последовательно пронумерованы натуральными числами 1,...,n. Предположим, что полоска складывается (сгибанием по линиям разбивки на клетки) таким образом, что все клетки находятся под одной единственной. Тогда каждому такому складыванию соответствует некоторая перестановка f=(a1,a2...,an), где a1 - номер клетки, расположенной сверху, a2 - номер клетки, расположенной  непосредственно  под a1,  и т. д.
<p>&nbsp;&nbsp;&nbsp;&nbsp;
<b><u>Определение.</u></b> Перестановка называется складываемой, если ей соответствует некоторое складывание полоски, и нескладываемой в противном случае.
<p>&nbsp;&nbsp;&nbsp;&nbsp;
Например, перестановка (3&nbsp;4&nbsp;2&nbsp;1) - складываемая, (3&nbsp;2&nbsp;4&nbsp;1) -нескладываемая.
<p>&nbsp;&nbsp;&nbsp;&nbsp;
В качестве операции, заданной на множестве всех перестановок, рассмотрим булевскую функцию, истинную для складываемых перестановок и ложную в противном случае. Для построения алгоритма вычисления этой логической функции разберем вначале алгоритм  вычисления аналогичной функции, принимающей истинное значение только в случае, когда единичная полоска склеена в кольцо так, что после n-й клетки следует первая.
<p>&nbsp;&nbsp;&nbsp;&nbsp;
Например, перестановка (3&nbsp;4&nbsp;2&nbsp;1) перестает быть складываемой для замкнутых единичных полосок четвертого порядка, а перестановка (3&nbsp;4&nbsp;1&nbsp;2) остается складываемой и в этом случае.

</BLOCKQUOTE><P>&nbsp;</TD><TD WIDTH="3%">&nbsp;</TD></TR></TABLE>



<TABLE WIDTH="100%" BORDER="0" CELLSPACING="0" CELLPADDING="3" BGCOLOR="#82B496">
<TR><TD COLSPAN="2" align=center>&nbsp;<font size="+1" color=white>

</font></TD></TR></TABLE>
<TABLE WIDTH="100%" BORDER="0" CELLSPACING="0" CELLPADDING="3" BGCOLOR="#82B496">
<TR><TD WIDTH="3%">&nbsp;</TD>
<TD WIDTH="97%" BGCOLOR="#EFEFEF"><BLOCKQUOTE><P>&nbsp;<p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;
Рассмотрим свойства складываемых перестановок, соответствующих замкнутым единичным полоскам:

<p>&nbsp;&nbsp;&nbsp;&nbsp;
<b><u>1.</u></b> Порядок складываемых перестановок, соответствующих замкнутым полоскам, четен.
<p>&nbsp;&nbsp;&nbsp;&nbsp;
Для доказательства этого свойства введем на полоске ориентацию. Сторону некоторой клетки полоски с номером i, 1&lt;i&lt;n, будем называть начальной (конечной), если она смежна с клеткой с меньшим (большим) номером. Для первой (n-й) клетки начальная сторона - это та, которая смежна с n-й ((n-1)-й) клеткой, а конечная - со второй (первой). Определим для начальных и конечных сторон ориентацию. Пусть замкнутая полоска представлена в сложенной форме. Выберем направление в зависимости от расположения начальной и конечной сторон клетки с номером 1 относительно ее центра. При этом будем считать, что начальная сторона первой клетки находится слева, а конечная - справа. Тогда начальным и конечным сторонам других клеток приписывается направление в зависимости от того, расположены ли они с той же стороны, что и начальная или конечная сторона первой клетки.
<p>&nbsp;&nbsp;&nbsp;&nbsp;
Заметим, что в этом случае начальные (конечные) стороны клеток с нечетным номером расположены слева (справа), а клеток с четными - наоборот. Поэтому отождествление начальной стороны первой клетки с конечной стороной n-й клетки для сложенной полоски возможно только при четном n.
<p>&nbsp;&nbsp;&nbsp;&nbsp;
<u><b>Упражнение.</b></u> <i>Используя введенное понятие ориентации, докажите, что у складываемых перестановок четные элементы находятся либо все на четных, либо все на нечетных местах.</i>
<p>&nbsp;&nbsp;&nbsp;&nbsp;
Рассмотрим пары смежных клеток полоски, общая сторона которых расположена справа.  Сюда относятся  пары   (1,2), (3,4),...,(n-1,n). При этом клетки с меньшим номером могут как предшествовать, так и следовать за клетками с большим номером, если рассматривать элементы складываемой перестановки от ее начала к концу. Эти пары смежных клеток образуют некоторую структуру частичной упорядоченности, определенную вложенностью друг в друга.
Например, n=10,  f=(5 4 9 10 3 6 7 2 1 8)
<p>&nbsp;&nbsp;&nbsp;&nbsp;
Естественно, что всегда существует хотя бы одна пара, в которую не вложены никакие другие. В приведенном примере это пары (9,10) и (2,1). Заметим, что элементы такой пары в перестановке расположены на двух соседних местах. Таким образом, можно сформулировать следующее свойство.

</BLOCKQUOTE><P>&nbsp;</TD></TR></TABLE>





<!-- -- -->
<TABLE WIDTH="100%" BORDER="0" CELLSPACING="0" CELLPADDING="3" BGCOLOR="#82B496">
<TR><TD COLSPAN="2" align=center><font size="+1" color=white>

&nbsp;</font></TD></TR></TABLE>
<TABLE WIDTH="100%" BORDER="0" CELLSPACING="0" CELLPADDING="3" BGCOLOR="#82B496">
<TR><TD WIDTH="97%" BGCOLOR="#EFEFEF"><BLOCKQUOTE><P>&nbsp;<p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;
<b><u>2.</u></b>Для любой складываемой перестановки существует хотя бы одно такое i, 1&lt;i&lt;n, что на i и i+1 местах расположены номера двух последовательных клеток полоски. Эти номера принадлежат множеству неупорядоченных пар {(1,2),(3,4),...,(n-1,n)}.
<p>&nbsp;&nbsp;&nbsp;&nbsp;
<u>Замечание.</u> Наряду с выбором пар смежных клеток полоски, общая сторона которых расположена справа, можно рассмотреть пары смежных клеток, общая сторона которых расположена слева. В этом случае пары образуют множество {(2,3),...,(n,1)}, а приведенный пример выглядит так: f=(5 4 9 10 3 6 7 2 1 8).

<p>&nbsp;&nbsp;&nbsp;&nbsp;
<b><u>3.</u></b>Перестановка четного порядка складываема тогда и только тогда, когда и справа, и слева смежные пары ее элементов образуют вложенную структуру. Проверка вложенности  справа (слева) может быть осуществлена последовательным удалением пар (свойство 2).
Например, n=10, f=(5 4 9 10 3 6 7 2 1 8).

<p>&nbsp;&nbsp;&nbsp;&nbsp;
<u><b>4.</b></u>Пусть f=(a1,...,an) - складываемая перестановка, тогда перестановка (b1,...,bn), где bi=(ai+m) mod (n+1), i=1,...,n, m - любое целое число, - также складываемая.
<p>&nbsp;&nbsp;&nbsp;&nbsp;
Данное преобразование фактически соответствует перенумерации клеток замкнутой полоски, при котором значение "единица" сопоставляется клетке с номером m mod (n +1).
<p>&nbsp;&nbsp;&nbsp;&nbsp;
<u>Замечание.</u> Для нечетных m меняется ориентация полоски, то есть левые стороны клеток становятся правыми, а правые - левыми.
<p>&nbsp;&nbsp;&nbsp;&nbsp;
На основе свойств 3 и 4 можно построить алгоритм вычисления булевской функции, истинной для складываемых перестановок замкнутых полосок и ложной в противном случае.
<pre><font size=-1>
const  n=...; {порядок перестановок}
type permit =array [1..n] of 1..n;
function sk (var f:permit):boolean;
 var i,a,b : integer;
     c:boolean;
 procedure skr;
  function pair(x,y:integer):boolean;
   var z:integer;
   begin if x)y then begin z:=x; x:=y; y:=z end;
        pair:=odd(y) or (y-x()1)
   end;
 procedure step;
  begin c:=c and (i(n);
         if c then begin i:=i+1; b:=f[i] end
end;
  procedure bc (a:integer);
   begin step;
         while pair(a,b) and c do bc(b);
         step
   end;
  begin {skr}
   a:=f[1]; b:=f[2]; i:=2;
   while i(n do
    begin if pair(a,b) and c then bc(b)
                             else begin i:=i+2;                  {1}
                                             a:=f[i-1];
                                              b:=f[i] 
                                  end
    end;
   c:=c and not pair(a,b)                                        {2}
  end;{skr}
 begin {sk}
  c:=true; skr;
  for i:=1 to n do f[i]:=f[i] mod n +1;
   skr;
   sk:=c
 end;</font>
</pre>

<p>&nbsp;&nbsp;&nbsp;&nbsp;
Комментарий. Переменная i служит для перебора элементов перестановки f; a,b определяют значения номеров клеток полоски, обрабатываемых в данный момент; c - булевская переменная, которая принимает значение false, если уже определено, что перестановка нескладываемая. 
<p>&nbsp;&nbsp;&nbsp;&nbsp;
Функция pair принимает значение false, если клетки с номером x и y образуют пару клеток полоски, смежную справа. При этом, если x, y - смежные справа клетки, эта пара исключается из перестановки.
<p>&nbsp;&nbsp;&nbsp;&nbsp;
Поиск пар смежных справа клеток (процедура skr) основан на последовательном просмотре элементов перестановки от меньших индексов к большим (процедура step, оператор {1} ). При этом хранение элементов, для которых еще не найдены парные, организовано в виде стека. Формирование этого стека осуществляется за счет рекурсивного вызова процедуры bc. Перестановка признается складываемой справа в том и только в том случае, если при просмотре элемента с наибольшим индексом стек полностью разгружается (оператор {2} ).
<p>&nbsp;&nbsp;&nbsp;&nbsp;
В разделе операторов функции sk вначале проверяется складываемость f справа, затем происходят переориентация f с помощью перенумерации ее элементов и проверка складываемости справа измененной перестановки.
<p>&nbsp;&nbsp;&nbsp;&nbsp;
Замечание. Нетрудно видеть, что функция sk имеет временную вычислительную сложность O(n).
<p>&nbsp;&nbsp;&nbsp;&nbsp;
Упражнение. Разработайте реализацию функции skr без использования рекурсии в процедуре bc.

</BLOCKQUOTE><P>&nbsp;</TD><TD WIDTH="3%">&nbsp;</TD></TR></TABLE>



<TABLE WIDTH="100%" BORDER="0" CELLSPACING="0" CELLPADDING="3" BGCOLOR="#82B496">
<TR><TD COLSPAN="2" align=center>&nbsp;<font size="+1" color=white>

</font></TD></TR></TABLE>
<TABLE WIDTH="100%" BORDER="0" CELLSPACING="0" CELLPADDING="3" BGCOLOR="#82B496">
<TR><TD WIDTH="3%">&nbsp;</TD>
<TD WIDTH="97%" BGCOLOR="#EFEFEF"><BLOCKQUOTE><P>&nbsp;<p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;

Возвратимся к незамкнутым складываемым единичным полоскам. Какие свойства сохраняются и для них, а какие изменяются?
<p>&nbsp;&nbsp;&nbsp;&nbsp;
Прежде всего об ориентации. Будем по-прежнему считать, что полоска ориентирована таким образом, что начальная сторона первой клетки находится слева, а конечная - справа. Естественно, что для таких полосок нет никаких ограничений на порядок, то есть порядок складываемых незамкнутых полосок может быть как четным, так и нечетным. Здесь сохраняется только свойство, что при четном порядке конечная сторона n-й клетки расположена слева, а при нечетном справа.
<p>&nbsp;&nbsp;&nbsp;&nbsp;
Свойство, сформулированное в упражнении и связанное с месторасположением четных элементов, для складываемых перестановок, соответствующих незамкнутым полоскам, может не выполняться.
<p>&nbsp;&nbsp;&nbsp;&nbsp;
Например, n=10, (10 8 7 4 2 1 3 5 6 8), (7 1 6 5 2 8 9 3 4 10) - складываемые перестановки.
<p>&nbsp;&nbsp;&nbsp;&nbsp;
С точки зрения построения алгоритма распознавания складываемости перестановок наиболее интересными были свойства 2-4. Остановимся вначале на 4 свойстве. Для незамкнутых полосок возможна только перенумерация клеток в обратном порядке, когда n-й клетке сопоставляется 1, (n-1)-й-2 и т.д. Такое преобразование изменяет перестановку (a1,...,an) на (n+1-a1,...,n+1-an). Заметим, что это преобразование меняет ориентацию перестановки только при нечетном n.
<p>&nbsp;&nbsp;&nbsp;&nbsp;
Алгоритм распознавания складываемых перестановок замкнутых полосок был основан на проверке структуры вложенности смежных клеток полоски справа (слева). А эта проверка, в свою очередь, строилась на последовательном удалении пар смежных клеток полоски, расположенных на двух рядом стоящих местах. Незамкнутая полоска характеризуется тем, что неупорядоченная пара (n,1), вообще говоря, не принадлежит к множеству смежных пар (слева, если n четно, и справа, если n нечетно). Это приводит к тому, что возможны ситуации, когда в складываемых перестановках нет двух смежных (слева, справа) элементов, расположенных на соседних местах.
<p>&nbsp;&nbsp;&nbsp;&nbsp;
Например, n=10, проверка складываемости слева
f=(1 3 8 7 4 10 5 6 9 2)

<p>&nbsp;&nbsp;&nbsp;&nbsp;
Причиной этого являются концевые клетки полоски (первая или последняя). Фактически в таких ситуация концевая клетка может быть интерпретирована как "неполная пара" смежных клеток и должна быть удалена на этом шаге. В данном примере такой концевой клеткой является клетка с номером 10. Ее заключительная сторона располагается справа, но для нее отсутствует смежная клетка, которая переводила бы "продолжение" полоски на левую сторону.
<p>&nbsp;&nbsp;&nbsp;&nbsp;
Обработка  таких "неполных" пар возникает: при четном n в случае проверки складываемости справа -для первой и последней клетки; при нечетном n - для первой клетки при проверке складываемости справа и для последней при проверке складываемости слева.
<p>&nbsp;&nbsp;&nbsp;&nbsp;
<u>Упражнение.</u> Разработайте алгоритм вычисления функции sk1, принимающей истинное значение для складываемых перестановок, соответствующих незамкнутым единичным полоскам, и ложное в противном случае.

</BLOCKQUOTE><P>&nbsp;</TD></TR></TABLE>





<!-- -- -->
<TABLE WIDTH="100%" BORDER="0" CELLSPACING="0" CELLPADDING="3" BGCOLOR="#82B496">
<TR><TD COLSPAN="2" align=center><font size="+1" color=white>

&nbsp;</font></TD></TR></TABLE>
<TABLE WIDTH="100%" BORDER="0" CELLSPACING="0" CELLPADDING="3" BGCOLOR="#82B496">
<TR><TD WIDTH="97%" BGCOLOR="#EFEFEF"><BLOCKQUOTE><P>&nbsp;<p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;

<u><b>Замечание 1.</b></u> Алгоритм проверки вложенности справа смежных пар клеток полоски основан на использовании автоматов с магазинной памятью для разбора правильных структур арифметических выражений. Более подробно можно познакомиться с идеями компиляции арифметических выражений, например, в [3]. В этой мастерски написанной книге, не устаревшей и в настоящее время, также рассмотрены многочисленные примеры решения "чисто математических" задач при помощи ЭВМ.
<p>&nbsp;&nbsp;&nbsp;&nbsp;
<u><b>Замечание 2.</b></u>Со складываемыми перестановками связана одна из интересных задач перечислительной комбинаторики, получившая в свое время название "Проблема С. Улама". Ее можно сформулировать следующим образом:
<p>&nbsp;&nbsp;&nbsp;&nbsp;
Можно ли с помощью элементарных операций арифметики и алгебры написать формулу, определяющую число складываемых перестановок, как функцию от n - порядка перестановок.
<p>&nbsp;&nbsp;&nbsp;&nbsp;
Другими словами, эту проблему можно сформулировать так. Хватает ли "изобразительной мощности" элементарных операций для того, чтобы выразить данное число складываемых перестановок. Здесь даже неважно, какие операции мы включаем в число элементарных. Более существенным является разработка математического аппарата для исследования подобных задач. Решение этой задачи можно сравнить с решением Десятой проблемы Гильберта о неразрешимости диофантовых множеств, окончательный ответ в решении которой был дан Ю. В. Mатиясевичем [4]. Разработка подобного аппарата выводит нас на самые современные методы математической логики, связанные с разрешимостью множеств. Проблема Улама актуальна с точки зрения компьютерной алгебры - в какой форме можно представить ответ на решение тех или иных достаточно сложных математических задач.
<p>&nbsp;&nbsp;&nbsp;&nbsp;
<b>Упражнение.</b> Обобщите изложенный в статье материал для прямоугольных карт формы n*m.


</BLOCKQUOTE><P>&nbsp;</TD><TD WIDTH="3%">&nbsp;</TD></TR></TABLE>



<TABLE WIDTH="100%" BORDER="0" CELLSPACING="0" CELLPADDING="3" BGCOLOR="#82B496">
<TR><TD COLSPAN="2" align=center>&nbsp;<font size="+1" color=white>
Литература.

</font></TD></TR></TABLE>
<TABLE WIDTH="100%" BORDER="0" CELLSPACING="0" CELLPADDING="3" BGCOLOR="#82B496">
<TR><TD WIDTH="3%">&nbsp;</TD>
<TD WIDTH="97%" BGCOLOR="#EFEFEF"><BLOCKQUOTE><P>&nbsp;<p>

<ol><li> М. Гарднер. Крестики - нолики: Пер. с англ. - М.: Мир, 1988
<li> Г. Э. Дьюдени. 520 головоломок: Пер. с. англ. - М.: Мир, 1975
<li> Ю. Нивергельт, Дж. Фаррар, Э. Рейнгольд. Машинный подход к решению математических задач: Пер. с англ. М.: Мир, 1977
<li> Ю. В. Матиясевич. Десятая проблема Гильберта. М.: Физматлит, 1993
</ol>
</BLOCKQUOTE><P>&nbsp;</TD></TR></TABLE>










<TABLE WIDTH="100%" BORDER="0" CELLSPACING="0" CELLPADDING="3" BGCOLOR="#82B496">
<TR><TD COLSPAN="2">&nbsp;</TD></TR></TABLE>
<TABLE WIDTH="100%" BORDER="0" CELLSPACING="0" CELLPADDING="3" BGCOLOR="#82B496">
<TR>
<TD WIDTH="70%" BGCOLOR="#EFEFEF">
&nbsp;<p><BLOCKQUOTE><STRONG>
Костин Владимир Андреевич, доцент кафедры информатики математико-механического 
факультета СПбГУ.

</STRONG></BLOCKQUOTE><P>&nbsp;</TD>
<TD WIDTH="30%" ALIGN="CENTER" VALIGN="MIDDLE"><FONT COLOR="White" SIZE="+2"><EM>&nbsp;НАШИ&nbsp;АВТОРЫ&nbsp;</EM></FONT></TD></TR>
<TR><TD COLSPAN="2" ALIGN="CENTER" VALIGN="MIDDLE" BGCOLOR="#82B496">
<FONT SIZE="-1"><HR SIZE="1" NOSHADE>
[ <A HREF="index.htm">начало</A> ] [ <A HREF="http://www.aec.neva.ru/center/">ЦПО</A> ] [ <A HREF="mailto:pozdnkov@aec.neva.ru">e-mail</A> ] 
<HR SIZE="1" NOSHADE></FONT></TD></TR></TABLE>


</BODY>
</HTML>
